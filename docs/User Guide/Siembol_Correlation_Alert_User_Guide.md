# Siembol Correlation Alert User Guide
## Overview
The correlation alert allows you to group several detections together before raising an alert. The primary use case for this is when you have a group of detections which indvidually shouldn't be alerted on (eg high volume or detections with high false positive rate) you can group several together to get more reliable alerts.

Rules are JSON configs generated by the UI. The raw JSON can be viewed through the UI as necessary or can be seen in the store repo for Siembol Alert.

## Accessing the UI 
From the Siembol home page, click the correlationalert editor button to load the UI.

[//]: # (Add picture of link to correlationalert)

## Creating / Editing a rule
### Correlationalert Editor - tabs
The correlationalert editor has 4 tabs;
- Rule description: allows you to add a description for 
- Correlation attributes: allows you to configure the correlation of detections
- Tags: allows you to add metadata tags to the alert
- Rule Protection: allows you to configure options to prevent alert flooding

[//]: # (Add picture of tabs - as seen from rule description page)

#### Rule description
 This tab simply allows you to enter a string description providing some context around the rule - eg what it does or which events it affects. This field is optional but recommeded.

 [//]: # (Probably don't need a picture in here provided the one above is of the whole rule description page)

#### Correlation attributes
The correlation attributes tab allows you to configure which detections to correlate together. 

To add this configuration click the "Add to Correlation Attributes"

[//]: # (Add picture of add to correlation attributes button)

This opens up the configuration options. 

The "Time Unit" field allows you to configure the time unit to use, this is a fixed option with the choices:
- hours
- minutes
- seconds

This is used in conjuction with the "Time Window" field to set the time window for the correlation. The "Time Window" field accepts an integer value. The requirements within this time window vary depending on the options you select - this is discussed further below.

You can also configure how the time window is calculated using the "Time computation type". There are two values for this:
- event_time: the time window is calculated using the timestamp field in the events, the timestamps need to be inside the time window for an alert to trigger
- processing_time: the time window is calcualted using the current time (when an alert is matched), the events need to be processed by the correlationalert component within the time window

[//]: # (Add picture of time fields)

The alerts threshold allows you to configure how many detections (you can specify which detections later) need to trigger in the time window for the alert to trigger. This field accepts an integer value, if it is left empty then all detections need to to trigger before an alert is created. 

To configure which detections to correlate  on click the "Add to Alerts" button

[//]: # (Add picture of add to alerts button)

For each detection you have three fields:
- Alert name: string, name of the detection (as named in the alert component)
- Threshold: integer, the number of times the detection has to trigger in the time window
- Mandatory: checkbox, whether a detection has to trigger within a time window in order for the rule to match

If the mandatory field is checked, the detection has to trigger before an alert is created - even if the alert threshold has already been reached. 

If the threshold field is set to more than 1, then if that condition is fulfilled it only counts as 1 detection towards the total alerts threshold. 

#### Tags
This is the same as the tags section in the [alert editor](Siembol_Alert_User_Guide.md#tags)
#### Rule Protection
This is the same as the tags section in the [alert editor](Siembol_Alert_User_Guide.md#rule-protection)